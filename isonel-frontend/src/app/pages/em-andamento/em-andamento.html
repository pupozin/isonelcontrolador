<div class="em-andamento-container container">

  <!-- Abas principais -->
  <div class="tabs">
    <button class="tab" [class.active]="abaAtiva === 'geral'" (click)="abaAtiva = 'geral'">Geral</button>
    <button class="tab" [class.active]="abaAtiva === 'processos'" (click)="abaAtiva = 'processos'">Processos</button>
  </div>

  <!-- Aba 1: Geral -->
  <div *ngIf="abaAtiva === 'geral'" class="aba-geral">
    <h2 class="titulo">Ativos: {{ processos.length }}</h2>

    <div class="cards-container">
      <div *ngFor="let p of processos" class="card-processo">
        <h4>Processo #{{ p.codigo }}</h4>
        <p><i class="fa-solid fa-circle" [style.color]="p.cor"></i> {{ p.status }}</p>
        <p><i class="fa-solid fa-diagram-project"></i> Etapa: {{ p.etapa }}</p>
        <p><i class="fa-solid fa-user"></i> Responsável: {{ p.responsavel }}</p>
        <p><i class="fa-solid fa-box"></i> Produto: {{ p.produto }}</p>

        <button class="btn-detalhes" (click)="abrirDetalhes(p)">Detalhes</button>
      </div>
    </div>
  </div>

  <!-- Aba 2: Processos -->
  <div *ngIf="abaAtiva === 'processos'" class="aba-processos">
        <div class="abas-internas">
        <button *ngFor="let etapa of etapas"
                [class.active]="etapa.nome === etapaAtiva"
                (click)="etapaAtiva = etapa.nome">
            {{ etapa.nome }} ({{ etapa.qtd }})
        </button>
        </div>

        <div class="lista-processos">
        <div *ngFor="let p of processos" class="linha-processo">
            <span>Processo #{{ p.codigo }}</span>
            <span><i class="fa-solid fa-circle" [style.color]="p.cor"></i>{{ p.status }}</span>
            <span><i class="fa-solid fa-user"></i> {{ p.responsavel }}</span>
            <span><i class="fa-solid fa-store"></i> {{ p.cliente }}</span>
            <button class="btn-detalhes" (click)="abrirDetalhes(p)">Detalhes</button>
            <button class="btn-acao" (click)="avancarEtapa(p)">Avançar etapa</button>
        </div>
        </div>
  </div>

  <!-- Modal -->
  <div class="modal-overlay" *ngIf="modalAberto" (click)="fecharModal()">
    <div class="modal" (click)="$event.stopPropagation()">
      <h3>Detalhes do processo</h3>
      <p><strong>Código:</strong> {{ processoSelecionado?.codigo }}</p>
      <p><strong>Etapa:</strong> {{ processoSelecionado?.etapa }}</p>
      <p><strong>Status:</strong> {{ processoSelecionado?.status }}</p>
      <p><strong>Responsável:</strong> {{ processoSelecionado?.responsavel }}</p>
      <button (click)="fecharModal()">Fechar</button>
    </div>
  </div>
</div>
